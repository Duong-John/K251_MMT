Note: Thay đổi 23/10/2025
- proxy.py: ở hàm run_proxy, khi proxy chạy, nó sẽ listen 50 client là nhiều nhất, khi đó, proxy sẽ có ip và port của nó, khi có client, nó sẽ có luôn conn và adrr của client. Dòng 202 thêm vào hàm handle_client để xử lý khi có client đến. Lưu ý: Chưa hiểu ý cách tạo "Multi-thread" ở đây cho lắm vì thầy dùng "while True" chạy tuần tự.
- back_end.py: Ta có từ proxy -> proxy.handle_client -> proxy.forward_request -> backend có port là 9000. Khi backend listen bắt được request được forward từ trên proxy xuống, nó tiến hành gọi cho backend chạy, và do mỗi proxy sẽ điều hướng tới 1 backend trong backend pool tương ứng, ta cũng phải handle_client những request truyền từ trên proxy xuống (Dòng 93).
- respone.py:
  + Hai elif dòng 318 và 320: Original code chưa hỗ trợ xử lý ảnh và icon nên ghi thêm.
  + Đoạn sub_if dòng 104: Do là cái original code của thầy nó chưa xử lý việc xử lý ảnh và icon nên phải thêm vào. Cụ thể, nếu là image/ thì sẽ có thể là image/png (welcome.png) hoặc x-icon nếu favicon.ico.
  + Đoạn 209-216: Đoạn đó là mới thêm vào, vì file ví dụ như index.html khi mình open thì open theo dạng "r" tức là đọc file bình thường rồi f.read(). Do là dạng file text bình thường, ta phải chuyển thành byte bằng cách encode, rồi gán nó với header rồi mới respone cho client được. Nhưng nếu trường hợp là ảnh hoặc icon thì ta buộc phải đọc theo byte nên phải phân ra thêm "rb", và đã là byte rồi thì không cần encode.
  + Đoạn 206-214: Hàm build_response_header(...) là đang xử lý định dạng header theo HTTP để sau đó send back vể client. Theo HTTP, định dạng chuẩn sẽ là <KEY> + ":" + " "+ <VALUE> + "/r/n", và bắt đầu của header sẽ là "HTTP/1.1 200 OK\r\n" (Do là thành công, còn trường hợp failed thì thầy đã xử lý bằng 404). Cuối header bắt buộc phải là "/r/n". Sau đó là encode header đó, và header này sẽ nằm trước Đoạn 209-216
